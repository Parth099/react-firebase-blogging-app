(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{6896:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return r(6535)}])},1216:function(e,t,r){"use strict";r.d(t,{Fs:function(){return o},l2:function(){return s},tO:function(){return u}});var n=r(5503),a=r(6257),i=r(1153),s=(0,n.ZF)({apiKey:"AIzaSyCTAWf19XUtFxaylypBNQQiKJMle-IS9fo",authDomain:"react-firebase-blogging-app.firebaseapp.com",projectId:"react-firebase-blogging-app",storageBucket:"react-firebase-blogging-app.appspot.com",messagingSenderId:"1046778962501",appId:"1:1046778962501:web:ff60eeaad6872c5605b92c"}),o=(0,a.ad)(s),u=(0,i.cF)(s)},6416:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(5893);r(7294);function a(e){return(0,n.jsxs)(n.Fragment,{children:[e.displaySpinner&&(0,n.jsx)("div",{className:"spinner-container flex items-center justify-center h-full",children:(0,n.jsx)("div",{className:"lds-dual-ring"})}),!e.displaySpinner&&e.children]})}},6288:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return u}});var n=r(5893),a=r(7294),i=r(1216),s=r(7702),o=(0,a.createContext)(null),u=function(){return(0,a.useContext)(o)};function c(e){var t=e.children,r=(0,s.v0)(i.l2),u=(0,a.useState)(null),c=u[0],l=u[1],d=(0,a.useState)(!1),f=d[0],p=d[1];(0,a.useEffect)((function(){return(0,s.Aj)(r,(function(e){l(e),p(!0)}))}),[]);var v={currentUser:c,signIn:function(e,t){return(0,s.e5)(r,e,t)},createAccount:function(e,t){return(0,s.Xb)(r,e,t)},logOut:function(){return(0,s.w7)(r)},firstLoadCompleted:f};return(0,n.jsx)(o.Provider,{value:v,children:t})}},9586:function(e,t,r){"use strict";function n(e,t,r,n,a,i,s){try{var o=e[i](s),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(a,i){var s=e.apply(t,r);function o(e){n(s,a,i,o,u,"next",e)}function u(e){n(s,a,i,o,u,"throw",e)}o(void 0)}))}}r.d(t,{X:function(){return P},y:function(){return U}});var i,s=r(4924),o=r(4051),u=r.n(o),c=r(5893),l=r(6257),d=r(1153),f=r(7294),p=r(1216),v=r(6288),h=new Uint8Array(16);function m(){if(!i&&!(i="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(h)}var x=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var g=function(e){return"string"===typeof e&&x.test(e)},b=[],j=0;j<256;++j)b.push((j+256).toString(16).substr(1));var w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(b[e[t+0]]+b[e[t+1]]+b[e[t+2]]+b[e[t+3]]+"-"+b[e[t+4]]+b[e[t+5]]+"-"+b[e[t+6]]+b[e[t+7]]+"-"+b[e[t+8]]+b[e[t+9]]+"-"+b[e[t+10]]+b[e[t+11]]+b[e[t+12]]+b[e[t+13]]+b[e[t+14]]+b[e[t+15]]).toLowerCase();if(!g(r))throw TypeError("Stringified UUID is invalid");return r};var y=function(e,t,r){var n=(e=e||{}).random||(e.rng||m)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=n[a];return t}return w(n)},N=(0,f.createContext)(null),U=function(){return(0,f.useContext)(N)};function P(e){var t=e.children,r=(0,v.a)(),n=(0,f.useState)(null),i=n[0],o=n[1],h=function(){var e=a(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.QT)(t);case 2:return r=e.sent,e.abrupt("return",!!r.exists()&&r.data());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=a(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,d.iH)(p.tO,t),e.next=3,(0,d.Jt)(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=a(u().mark((function e(t,r,n){var a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,l.JU)(p.Fs,"main:profiles/".concat(t)),e.next=3,h(a);case 3:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,(0,l.r7)(a,(0,s.Z)({},r,n));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),g=function(){var e=a(u().mark((function e(t){var r,n,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,l.hJ)(p.Fs,"main:profiles"),n=(0,l.IO)(r,(0,l.ar)("username","==",t)),e.next=4,(0,l.PL)(n);case 4:return a=e.sent,e.abrupt("return",0===a.size);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=a(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,l.JU)(p.Fs,"main:blogs",t),e.next=3,h(r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=a(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,l.JU)(p.Fs,"main:blogs",t),e.next=3,(0,l.r7)(n,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();(0,f.useEffect)((function(){if((null===r||void 0===r?void 0:r.currentUser)&&r.currentUser.email){var e=r.currentUser.email,t=(0,l.JU)(p.Fs,"main:profiles/".concat(e));h(t).then((function(r){r||(0,l.pl)(t,{email:e,dateCreated:new Date,username:"",profilePictureName:"default_pfp.jpg",uuid:y()})}))}}),[r]),(0,f.useEffect)((function(){if(null===r||void 0===r?void 0:r.currentUser){var e=r.currentUser.email;return(0,l.cf)((0,l.JU)(p.Fs,"main:profiles/".concat(e)),(function(e){var t=e.data();if(t){var r={email:t.email,username:t.username,profilePictureName:t.profilePictureName,dateCreated:t.dateCreated,uuid:t.uuid};o(r)}}))}}),[r]);var w={profileData:i,getImageUrlFromStorage:m,updatePfp:function(e,t){var r=(0,d.iH)(p.tO,"".concat(t));return(0,d.KV)(r,e)},sendProfileDocUpdate:x,isUsernameAreadyUsed:g,blogsRef:(0,l.hJ)(p.Fs,"main:blogs"),getDocDataById:b,updateDocumentById:j};return(0,c.jsx)(N.Provider,{value:w,children:t})}},6535:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var n=r(6042);function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}var i=r(5893),s=r(7294),o=r(6257),u=r(9586),c=r(6288),l=r(6416);function d(e){var t=(0,s.useRef)(null);return(0,i.jsxs)("div",{className:"editable-field-container min-h-[75px] mt-1",children:[!e.editorMode&&(0,i.jsx)("h4",{className:"text-white text-xl font-bold",children:e.value?e.value:e.defaultValue}),e.editorMode&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("input",{type:"text",className:"input-field w-full",ref:t,defaultValue:e.value,placeholder:"..."}),(0,i.jsx)("button",{type:"button",className:"px-3 py-2 bg-white hover:bg-sp1",onClick:function(){var r=t.current.value;r&&e.updateValue(r)},children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{d:"M9 22l-10-10.598 2.798-2.859 7.149 7.473 13.144-14.016 2.909 2.806z"})})})]}),(0,i.jsx)("p",{className:"err-msg block font-sm text-red-500 font-bold",children:e.errorMessage})]})]})}var f=r(1664),p=r.n(f);function v(e){var t=e.blogs;return t?(0,i.jsx)("div",{className:"blog-list-container",children:t.map((function(e){var t=e.created.toDate();return(0,i.jsx)(p(),{href:"/edit-post/".concat(e.id),children:(0,i.jsxs)("div",{className:"blog-list-element flex flex-col text-white p-3 ml-4 border-l-2 border-l-white hover:border-l-sp1",children:[(0,i.jsx)("h3",{className:"title text-2xl font-bold",children:e.title}),(0,i.jsx)("p",{className:"text-md",children:t.toLocaleString()})]})},e.id)}))}):(0,i.jsx)(i.Fragment,{})}function h(){var e,t=(0,u.y)(),r=(0,c.a)(),f=null===t||void 0===t?void 0:t.profileData,p=(0,s.useState)(1),h=p[0],m=p[1],x=(0,s.useState)(""),g=x[0],b=x[1];(0,s.useEffect)((function(){f&&t.getImageUrlFromStorage(f.profilePictureName).then((function(e){b(e)}))}),[f,h]);var j=(0,s.useState)(!1),w=j[0],y=j[1],N=(0,s.useState)(""),U=N[0],P=N[1],O=(0,s.useState)(null),S=O[0],C=O[1];return(0,s.useEffect)((function(){var e;if((null===r||void 0===r||null===(e=r.currentUser)||void 0===e?void 0:e.email)&&(null===t||void 0===t?void 0:t.blogsRef)){var i=(0,o.IO)(t.blogsRef,(0,o.ar)("createdBy","==",r.currentUser.email),(0,o.Xo)("created","desc"));(0,o.PL)(i).then((function(e){var t=[];e.forEach((function(e){var r=e.data();t.push(a((0,n.Z)({},r),{id:e.id}))})),C(t)}))}}),[r,t]),(0,i.jsx)("section",{className:"w-full p-8 flex justify-center",children:(0,i.jsx)("div",{className:"w-288 bg-sp4 rounded-md shadow-lg",children:(0,i.jsx)(l.Z,{displaySpinner:!f,children:f&&(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsx)("h2",{className:"text-4xl text-sp1 header-font border-b-sp1 border-b-2 pb-2 mb-5",children:"Profile"}),(0,i.jsxs)("div",{className:"flex gap-8",children:[(0,i.jsxs)("label",{className:"img-cont w-64 h-64 block relative cursor-pointer border-white border-2",htmlFor:"upload-image",children:[(0,i.jsx)("input",{type:"file",id:"upload-image",className:"hidden",onChange:function(e){if(e.target.files){var n=e.target.files[0],a=n.type;if(/image\/(png|jpg|jpeg)/.test(a)){var i=f.profilePictureName;t.updatePfp(n,i).then((function(){var e,n=null===r||void 0===r||null===(e=r.currentUser)||void 0===e?void 0:e.email;n&&t.sendProfileDocUpdate(n,"profilePictureName",i).then((function(){return m((function(e){return e+1}))}))}))}}}}),(0,i.jsx)(l.Z,{displaySpinner:""===g,children:h>0&&(0,i.jsx)("img",{src:g,alt:"profile image",className:"w-full h-full text-sp4 "})}),(0,i.jsxs)("div",{className:"upload-cont absolute w-full bottom-0 left-0 light-overlay p-3 flex justify-center",children:[(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{d:"M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12-5.373-12-12-12-12 5.373-12 12zm18-1h-4v7h-4v-7h-4l6-6 6 6z"})}),(0,i.jsx)("span",{className:"pl-3 self-center font-bold header-font text-lg",children:"Upload"})]})]}),(0,i.jsxs)("div",{className:"info-col flex flex-col gap-4 justify-center",children:[(0,i.jsxs)("section",{children:[(0,i.jsx)("h3",{className:"std-label header-font",children:"Email"}),(0,i.jsx)("h4",{className:"text-white text-xl font-bold",children:null===r||void 0===r||null===(e=r.currentUser)||void 0===e?void 0:e.email})]}),(0,i.jsxs)("section",{children:[(0,i.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,i.jsx)("h3",{className:"std-label header-font",children:"Username"}),(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",className:"fill-sp1 hover:fill-sp2",onClick:function(){y((function(e){return!e}))},children:(0,i.jsx)("path",{d:"M19.769 9.923l-12.642 12.639-7.127 1.438 1.438-7.128 12.641-12.64 5.69 5.691zm1.414-1.414l2.817-2.82-5.691-5.689-2.816 2.817 5.69 5.692z"})})]}),(0,i.jsx)("div",{className:"w-76",children:(0,i.jsx)(d,{editorMode:w,updateValue:function(e){var n,a=null===r||void 0===r||null===(n=r.currentUser)||void 0===n?void 0:n.email;a&&(/[0-9a-z\_]+/.test(e)?t.isUsernameAreadyUsed(e).then((function(r){e!==(null===f||void 0===f?void 0:f.username)?r?(null===t||void 0===t||t.sendProfileDocUpdate(a,"username",e),y(!1),P("")):P("".concat(e," already in use")):y(!1)})):P("Only letters, numbers and underscores allowed"))},value:f.username,defaultValue:"Not set",errorMessage:U})})]})]})]}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{className:"text-4xl text-sp1 header-font border-b-sp1 border-b-2 pb-2 my-5",children:"Your Blog Posts"}),(0,i.jsx)(v,{blogs:S})]})]})})})})}}},function(e){e.O(0,[16,440,921,664,774,888,179],(function(){return t=6896,e(e.s=t);var t}));var t=e.O();_N_E=t}]);